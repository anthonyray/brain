window.$ = window.jQuery = require('jquery'); // I know, this is a very bad practice !
var neural = require('./network');
var network = new neural.Network();

// Fetching data from an already trained network.
network.deserialize(20,'{"layers":[{"neurons":[{"weights":[-0.13231304604560137,0.013423559814691538,0.13292986834421755,0.11043849419802426,0.12471729125827552,-0.1764357483945787,0.1436347710900009,0.05244312817230823,-0.12117593185976148,0.14464364405721425,-0.07882626075297594,-0.08191179847344757,0.01699586501345038,0.1917704198509455,-0.027427815739065414,0.11666309311985973,0.017067410238087166,-0.15392441004514695,-0.10967022012919188,0.19912444455549122],"bias":0.006284583639353525,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.5588195139227673,"error":0.001459822436850761,"delta":0.00036489813601126134},{"weights":[0.19758801562711598,0.026674893870949734,-0.016566485166549683,0.1095585161820054,0.02275830674916507,0.012699265591800207,-0.17466646423563362,0.05596894128248098,-0.17375609232112765,0.1647485394962132,0.08480631345883011,-0.13471739953383804,-0.10248542055487633,0.19109388124197724,0.18253984181210398,0.18844181867316367,-0.1696857704780996,0.17366193458437923,0.06331474306061863,0.09342220714315774],"bias":0.014001947734504944,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.7008226286121002,"error":-0.002372991658065866,"delta":-0.0005673113825048576},{"weights":[0.17685568016022446,-0.04029337614774703,-0.024473504722118372,0.06013172958046198,0.12646144125610592,-0.15359952114522457,0.1761435454711318,-0.046385546680539846,0.10155004952102903,-0.13535938523709773,-0.09689982030540706,-0.12013610536232591,0.08609543005004527,-0.020848445687443012,0.02756297811865807,-0.1941495805978775,-0.10948295863345266,0.15685360757634043,-0.03954018298536538,-0.16287212586030364],"bias":-0.19001387683674695,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.31739583636691043,"error":0.00344202747042678,"delta":0.0008599038668056716},{"weights":[-0.051378183346241724,-0.0001416740007698647,-0.186212498228997,0.08944645719602706,-0.14896242320537567,-0.10445549292489886,0.06980112129822375,0.11600561663508419,0.16628623539581894,-0.11929175145924092,-0.18886058786883952,-0.0870102028362453,-0.024503613635897648,0.11253182999789718,-0.02703697020187973,-0.1723796014674008,0.11940659051761032,-0.12353400625288487,-0.1524919591844082,0.14421956809237602],"bias":-0.17682836754247547,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.3123725604056417,"error":0.0029159882328353396,"delta":0.0006349909156823679},{"weights":[0.09503604322671888,0.12583621237426995,0.19163306010887027,0.1444393373094499,0.1885062727145851,-0.032306286226958025,0.03634673319756984,-0.13422560645267367,0.17365043377503753,-0.12197643592953683,0.10748715680092574,0.07334444960579278,0.006472316943109041,-0.125519631896168,0.062223068345338084,0.018333062529563904,0.06174435606226325,-0.18511627009138465,0.18202182026579977,0.14778362587094307],"bias":0.021725714020431053,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.6743808416386342,"error":-0.00293047193182303,"delta":-0.0006017917303911181},{"weights":[-0.1049504891037941,-0.06246471907943488,0.19858602359890937,0.0634995814412832,-0.042210101988166576,-0.09942369917407633,-0.12797634648159145,-0.08582835514098407,0.05709207952022555,0.05610632384195924,0.05604417044669391,-0.09221741575747729,0.1648711755871773,0.00354464417323469,0.07734947800636294,0.10815455671399832,-0.0028504429385066143,0.16221191454678774,-0.18016262184828521,-0.10199257163330913],"bias":-0.11905480157583953,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.47379432323173254,"error":0.0017976541304065923,"delta":0.00044890160461476215},{"weights":[-0.06015812940895557,0.09188227588310838,-0.0135133035480976,0.15310646956786517,-0.06404139539226891,0.10074024684727195,0.1329826220870018,-0.005667649209499359,0.047326900996267796,-0.10821141442283988,-0.0843934316188097,0.15087888911366465,-0.04785018274560571,0.04376564407721162,0.14193786773830652,0.04803686495870352,-0.16232818672433497,0.18337633479386567,-0.06326291309669616,-0.16407845104113222],"bias":0.17961471099406484,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.5362567667178704,"error":0.0015095093943176749,"delta":0.00034537923235443126},{"weights":[-0.19363410351797938,-0.13041773075237872,0.15971623146906494,0.16866192789748313,0.04033917421475053,0.11788101205602292,0.13704855451360348,0.19414108898490667,0.1073947140015662,-0.16241699652746322,0.03369484916329385,-0.02527291784062982,-0.045961526781320566,-0.0917811687104404,-0.12192081194370985,-0.16274380907416344,-0.16436997363343836,0.15737963104620578,0.15974471475929025,0.09986320436000823],"bias":-0.11723050503060223,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.5042787983723299,"error":-0.0013240859177048707,"delta":-0.0003230888119931367},{"weights":[0.14846534980461001,-0.174320630915463,-0.032638459652662266,-0.0037651637569069973,0.19352533733472227,-0.08964943895116449,-0.04285894595086576,-0.07578764306381346,0.19786910368129612,-0.1795168625190854,-0.1583773460239172,-0.0647012402303517,-0.06880736919119954,0.1633452309295535,0.12769642071798443,-0.023737184703350067,0.17899616649374367,0.18564004125073552,-0.16274185767397287,0.005030931066721672],"bias":-0.0436937315389514,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.4010366403516713,"error":0.00006192186882577645,"delta":0.00001545854020520784},{"weights":[-0.04920039726421238,-0.15833217510953546,0.00811991300433873,-0.16079892283305527,0.017102654743939627,0.0657668518833816,-0.14807317713275553,0.17228097943589094,0.18484566379338502,-0.0865098249167204,-0.002764733321964752,0.12511851619929076,-0.16823864961043,0.1509837473742664,-0.0636981318704784,0.08522181576117871,0.12981342263519763,0.022518365178257227,-0.09861841816455126,0.12832107758149508],"bias":-0.08444903073832394,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.5076795429043943,"error":0.003753031992894003,"delta":0.0009357045835131109},{"weights":[-0.17605734067037704,-0.05957692228257658,0.16012012492865324,-0.07851236294955016,-0.08289904417470098,-0.14399864980950952,-0.1395566043443978,-0.0698071287944913,-0.18591739581897856,0.1955387692898512,-0.024168569222092623,-0.15820733308792115,-0.07067337976768615,-0.0004191537387669142,-0.09406650010496379,0.17872835192829373,0.058748306427150954,-0.1850220591761172,-0.1362401546910405,-0.06975828902795911],"bias":-0.18135430617257953,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.36689306464007726,"error":-0.0009182695199514387,"delta":-0.00017672166018638773},{"weights":[-0.18131165811792016,-0.0047114756889641285,-0.19557503992691638,-0.1327426077798009,-0.13840539725497367,0.09124799137935041,0.07710640812292696,-0.04974373904988169,-0.03942702542990445,0.0658922496251762,0.038880457077175384,0.06638404596596958,0.15518900044262413,0.1849777691066265,0.018147730175405746,-0.16145006306469442,0.14198821373283865,-0.14964554570615293,0.1073611689731479,-0.08132733944803477],"bias":0.112078080419451,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.3955783323458593,"error":-0.001919333202879583,"delta":-0.00043756640615473703},{"weights":[-0.0792843452654779,-0.050287111848592775,-0.1485850871540606,0.02718862546607853,0.05538642145693301,0.1708786942996085,-0.01503800880163908,-0.05149576617404819,0.03742270665243269,-0.08250032793730498,-0.17377452338114383,0.024263186007738108,-0.17428050106391313,-0.08657284686341882,-0.08360654162243009,0.14421758418902758,0.013047600165009499,0.011545218992978334,-0.06610979987308382,0.07582478690892458],"bias":0.031519588734954584,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.4195964135295919,"error":-0.002816331024101385,"delta":-0.0006941645250430142},{"weights":[-0.08528280155733228,0.08287758016958835,-0.042954714316874754,-0.07273175669834017,0.195308933686465,0.05774499699473379,-0.015485682617872948,-0.11315125906839968,0.014931526221334923,0.1975919546559453,0.16634610248729587,0.15332232406362895,0.11270065223798159,0.029033660981804127,0.04287201268598437,0.1406484906561673,0.11505678044632078,-0.06832455080002547,0.16853620605543257,0.12793677709996704],"bias":0.029407116305083025,"lastInputs":[1,1,1,1,0,0,0,1,0,1,1,1,0,0,0,1,1,1,1,1],"lastOutput":0.6898200705316853,"error":-0.0003918418785701003,"delta":-0.00009173512143330482}]},{"neurons":[{"weights":[17.598974084715053,53.44667491012758,-21.61852078849081,11.287992183397026,6.985924029933104,-5.380576313120969,-26.471648178204205,-1.9448817417492217,-23.222225331395073,3.526817797626979,-5.621868555657057,-12.641493505718149,-34.05264360964642,10.345802930487174],"bias":1.9809252434636333,"lastInputs":[0.5588195139227673,0.7008226286121002,0.31739583636691043,0.3123725604056417,0.6743808416386342,0.47379432323173254,0.5362567667178704,0.5042787983723299,0.4010366403516713,0.5076795429043943,0.36689306464007726,0.3955783323458593,0.4195964135295919,0.6898200705316853],"lastOutput":0.9999861158495548,"error":-0.004801316400113381,"delta":-0.000022941956159465704},{"weights":[-37.7063547361161,23.203764498714783,-59.608411520666394,-64.23976642486903,56.05005082642273,-33.87486150560051,-18.254492832739842,27.69328692857684,9.526596846441961,-77.57320060485864,21.18917740764037,44.70239357025301,72.7904299041288,3.1258020308764145],"bias":0.8150892356117547,"lastInputs":[0.5588195139227673,0.7008226286121002,0.31739583636691043,0.3123725604056417,0.6743808416386342,0.47379432323173254,0.5362567667178704,0.5042787983723299,0.4010366403516713,0.5076795429043943,0.36689306464007726,0.3955783323458593,0.4195964135295919,0.6898200705316853],"lastOutput":0.9960867316813478,"error":-0.007055122880515211,"delta":-0.00004942359181906979}]}]}');

$(document).ready(function() {
  $.material.init();

  $("#clear").click(function(){
    $("#matrix td").each(function(index){
      $(this).removeClass("digit");
    });
  });

  $("#tryagain").click(function(){
    $("#guessednumber").empty();
  });

  $("#guess").click(function(){
    var digit = [];
    $("#matrix td").each(function(index){
      if ($(this).hasClass('digit')){
        digit.push(1);
      }
      else{
        digit.push(0);
      }
    });
    console.log(digit);
    var outputs = network.process(digit);
    var binary  = outputs.map(function(v) { return Math.round(v) }).join("");
    var decimal = parseInt(binary, 2);
    $("#guessednumber").empty().text(decimal);
    $("#guessednumber").removeClass().addClass('animated bounceIn').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
      $(this).removeClass();
    });;
  });

  $("#matrix td").click(function(){
    $(this).toggleClass('digit');
  });

});
